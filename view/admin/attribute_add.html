{% extends "./inc/base.html" %}
{% block content %}
<section class="vbox">
    <header class="header bg-light dk">
        <p>{{meta_title}} <strong class="text-primary-dker">{{modelname}}</strong> 字段 <a
                href="/admin/attribute/index/model_id/{{model_id}}" class="text-info-dk"><i class="fa fa-reply"></i> 返回列表</a>
        </p>
    </header>
    <section class="scrollable wrapper">
        <div class="row">
            <div class="col-lg-12">
                <section class="panel panel-default">
                    <header class="panel-heading text-right bg-light clearfix">
                        <ul class="nav nav-tabs pull-left">
                            <li class="active"><a data-toggle="tab" href="#tab-1"><i class="fa fa-cog text-muted"></i>
                                基础</a></li>
                            <li class=""><a data-toggle="tab" href="#tab-2"><i class="fa fa-cog text-muted"></i> 高级</a>
                            </li>
                        </ul>

                    </header>
                    <div class="panel-body">
                        <form id="ajaxForm" method="post" class="form-horizontal" action="/admin/attribute/update"
                              data-validate="parsley">
                            <div class="tab-content">

                                <div id="tab-1" class="tab-pane fade active in">
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">字段名</label>

                                        <div class="col-sm-10">

                                            <div class="row">
                                                <div class="col-md-4">
                                                    <input type="text" class="form-control  " name="name"
                                                           value="{{info.name}}" data-required="true">
                                                </div>
                                                <div class="col-md-12">
                                                    <span class="help-block m-b-none">请输入字段名 英文字母开头，长度不超过30</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="line line-dashed b-b line-lg pull-in"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">字段标题</label>

                                        <div class="col-sm-10">
                                            <div class="row">
                                                <div class="col-md-4">
                                                    <input type="text" class="form-control  " name="title"
                                                           value="{{info.title}}"
                                                           data-required="true">
                                                </div>
                                                <div class="col-md-12">
                                                    <span class="help-block m-b-none">请输入字段标题，用于表单显示</span>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                    <div class="line line-dashed b-b line-lg pull-in"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">字段类型</label>

                                        <div class="col-sm-10">
                                            <div class="row">
                                                <div class="col-md-4 ">
                                                    <select class="form-control " name="type" id="data-type">
                                                        <option value="">----请选择----</option>
                                                        {% for key ,value in null|get_attribute_type %}
                                                        <option value="{{key}}" rule="{{value[1]}}" {% if info.extend==
                                                                0 %}selected {% endif %}>
                                                            {{value[0]}}
                                                        </option>
                                                        {% endfor %}
                                                    </select>
                                                </div>
                                                <div class="col-md-12">
                                                    <span class="help-block m-b-none">用于表单中的展示方式</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="line line-dashed b-b line-lg pull-in"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">字段定义</label>

                                        <div class="col-sm-10">
                                            <div class="row">
                                                <div class="col-md-4">
                                                    <input type="text" class="form-control  " name="field"
                                                           value="{{info.field}}" id="data-field" data-required="true">
                                                </div>
                                                <div class="col-md-12">
                                                    <span class="help-block m-b-none">字段属性的sql表示</span>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                    <div class="line line-dashed b-b line-lg pull-in"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">参数</label>

                                        <div class="col-sm-10">
                                            <div class="row">
                                                <div class="col-md-4 ">
                                                    <textarea name="extra" class="form-control">{{info.extra}}</textarea>
                                                </div>
                                                <div class="col-md-12">
                                                    <span class="help-block m-b-none">布尔、枚举、多选字段类型的定义数据</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="line line-dashed b-b line-lg pull-in"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">默认值</label>

                                        <div class="col-sm-10">
                                            <div class="row">
                                                <div class="col-md-4">
                                                    <input type="text" class="form-control  " name="value"
                                                           value="{{info.value}}">
                                                </div>
                                                <div class="col-md-12">
                                                    <span class="help-block m-b-none">字段的默认值</span>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                    <div class="line line-dashed b-b line-lg pull-in"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">字段备注</label>

                                        <div class="col-sm-10">
                                            <div class="row">
                                                <div class="col-md-4">
                                                    <input type="text" class="form-control  " name="remark"
                                                           value="{{info.remark}}">
                                                </div>
                                                <div class="col-md-12">
                                                    <span class="help-block m-b-none">用于表单中的提示</span>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                    <div class="line line-dashed b-b line-lg pull-in"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">是否显示</label>

                                        <div class="col-sm-10">
                                            <div class="row">
                                                <div class="col-md-4 ">
                                                    <select class="form-control " name="is_show">
                                                        <option value="1">始终显示</option>
                                                        <option value="2">新增显示</option>
                                                        <option value="3">编辑显示</option>
                                                        <option value="0">不显示</option>
                                                    </select>
                                                </div>
                                                <div class="col-md-12">
                                                    <span class="help-block m-b-none">是否显示在表单中</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="line line-dashed b-b line-lg pull-in"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">是否必填</label>

                                        <div class="col-sm-10">
                                            <div class="row">
                                                <div class="col-md-4 ">
                                                    <select class="form-control " name="is_must">
                                                        <option value="0">否</option>
                                                        <option value="1">是</option>
                                                    </select>
                                                </div>
                                                <div class="col-md-12">
                                                    <span class="help-block m-b-none">用于自动验证</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                                <div id="tab-2" class="tab-pane fade">
                                    <div class="line line-dashed b-b line-lg pull-in"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">验证方式</label>

                                        <div class="col-sm-10">
                                            <div class="row">
                                                <div class="col-md-4 ">
                                                    <select class="form-control " name="validate_type">
                                                        <option value="regex">正则验证</option>
                                                        <option value="function">函数验证</option>
                                                        <option value="unique">唯一验证</option>
                                                        <option value="length">长度验证</option>
                                                        <option value="in">验证在范围内</option>
                                                        <option value="notin">验证不在范围内</option>
                                                        <option value="between">区间验证</option>
                                                        <option value="notbetween">不在区间验证</option>
                                                    </select>
                                                </div>
                                                <div class="col-md-12">
                                                    <span class="help-block m-b-none"></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="line line-dashed b-b line-lg pull-in"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">验证规则</label>

                                        <div class="col-sm-10">
                                            <div class="row">
                                                <div class="col-md-4 ">
                                                    <input type="text" class="form-control" name="validate_rule" value="{{info.validate_rule}}">
                                                </div>
                                                <div class="col-md-12">
                                                    <span class="help-block m-b-none">（根据验证方式定义相关验证规则）</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="line line-dashed b-b line-lg pull-in"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">出错提示</label>

                                        <div class="col-sm-10">
                                            <div class="row">
                                                <div class="col-md-4 ">
                                                    <input type="text" class="form-control" name="error_info" value="{{info.error_info}}">
                                                </div>
                                                <div class="col-md-12">
                                                    <span class="help-block m-b-none"></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="line line-dashed b-b line-lg pull-in"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">验证时间</label>

                                        <div class="col-sm-10">
                                            <div class="row">
                                                <div class="col-md-4 ">
                                                    <select class="form-control " name="validate_time">
                                                        <option value="3">始 终</option>
                                                        <option value="1">新 增</option>
                                                        <option value="2">编 辑</option>
                                                    </select>
                                                </div>
                                                <div class="col-md-12">
                                                    <span class="help-block m-b-none"></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="line line-dashed b-b line-lg pull-in"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">自动完成方式</label>

                                        <div class="col-sm-10">
                                            <div class="row">
                                                <div class="col-md-4 ">
                                                    <select class="form-control " name="auto_type">
                                                        <option value="function">函数</option>
                                                        <option value="field">字段</option>
                                                        <option value="string">字符串</option>
                                                    </select>
                                                </div>
                                                <div class="col-md-12">
                                                    <span class="help-block m-b-none"></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="line line-dashed b-b line-lg pull-in"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">自动完成规则</label>

                                        <div class="col-sm-10">
                                            <div class="row">
                                                <div class="col-md-4 ">
                                                    <input type="text" class="form-control" name="auto_rule" value="{{info.auto_rule}}">
                                                </div>
                                                <div class="col-md-12">
                                                    <span class="help-block m-b-none">根据完成方式订阅相关规则</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="line line-dashed b-b line-lg pull-in"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">自动完成时间</label>

                                        <div class="col-sm-10">
                                            <div class="row">
                                                <div class="col-md-4 ">
                                                    <select class="form-control " name="auto_time">
                                                        <option value="3">始 终</option>
                                                        <option value="1">新 增</option>
                                                        <option value="2">编 辑</option>
                                                    </select>
                                                </div>
                                                <div class="col-md-12">
                                                    <span class="help-block m-b-none"></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <div class="line line-dashed b-b line-lg pull-in"></div>
                            <div class="form-group">
                                <div class="col-sm-4 col-sm-offset-2">
                                    {% if info.id %}
                                    <input type="hidden" name="id" value="{{info.id}}">
                                    {% endif %}
                                    <input type="hidden" name="model_id" value="{{model_id}}"/>
                                    <button class="btn btn-primary btn-s-md ajax-post " type="submit"
                                            target-form="form-horizontal">确定
                                    </button>
                                    <button class="btn btn-default" onclick="javascript:history.back(-1);return false;"
                                            type="submit">返回
                                    </button>

                                </div>
                            </div>
                        </form>
                    </div>
                </section>
            </div>
        </div>
    </section>
</section>
{% endblock %}

{% block script %}
<script src="/static/js/parsley/parsley.min.js" type="text/javascript"></script>
<script src="/static/js/parsley/parsley.extend.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function () {
        $('#data-type').change(function () {
            $('#data-field').val($(this).find('option:selected').attr('rule'));
        });
    })
</script>
{% endblock%}